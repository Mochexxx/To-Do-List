<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>React Test Window</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <!-- React and ReactDOM CDN -->
        <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
        <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
        <!-- Babel for JSX support -->
        <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
        <style>
            body { font-family: Arial, sans-serif; margin: 2rem; }
            #root { border: 1px solid #ccc; padding: 2rem; border-radius: 8px; }
        </style>
    </head>
    <body>
        <div id="root"></div>        <script type="text/babel">            function LoginPage({ setCurrentPage }) {
                const [email, setEmail] = React.useState('');
                const [password, setPassword] = React.useState('');
                const [remember, setRemember] = React.useState(false);

                const handleSubmit = (e) => {
                    e.preventDefault();
                    console.log({ email, password, remember });
                    // TODO: integrar authService.login
                };

                return (
                    <div style={{ maxWidth: '400px', margin: '2rem auto' }}>
                        <button onClick={() => setCurrentPage('main')} style={{ marginBottom: '1rem' }}>
                            Back
                        </button>
                        <h2>Login</h2>
                        <form onSubmit={handleSubmit}>
                            <div style={{ marginBottom: '1rem' }}>
                                <label htmlFor="email">Email</label>
                                <input
                                    id="email"
                                    type="email"
                                    value={email}
                                    onChange={e => setEmail(e.target.value)}
                                    required
                                    style={{ width: '100%', padding: '0.5rem' }}
                                />
                            </div>
                            <div style={{ marginBottom: '1rem' }}>
                                <label htmlFor="password">Senha</label>
                                <input
                                    id="password"
                                    type="password"
                                    value={password}
                                    onChange={e => setPassword(e.target.value)}
                                    required
                                    style={{ width: '100%', padding: '0.5rem' }}
                                />
                            </div>
                            <div style={{ marginBottom: '1rem' }}>
                                <label>
                                    <input
                                        type="checkbox"
                                        checked={remember}
                                        onChange={e => setRemember(e.target.checked)}
                                        style={{ marginRight: '0.5rem' }}
                                    />
                                    Lembrar senha
                                </label>
                            </div>
                            <button type="submit" style={{ padding: '0.5rem 1rem' }}>
                                Login
                            </button>
                        </form>
                    </div>
                );
            }

            function RegisterPage({ setCurrentPage }) {
                const [username, setUsername] = React.useState('');
                const [email, setEmail] = React.useState('');
                const [password, setPassword] = React.useState('');
                const [confirmPassword, setConfirmPassword] = React.useState('');
                const [captcha, setCaptcha] = React.useState('');
                const [captchaAnswer, setCaptchaAnswer] = React.useState(generateCaptcha());
                const [errors, setErrors] = React.useState({});

                function generateCaptcha() {
                    const num1 = Math.floor(Math.random() * 10) + 1;
                    const num2 = Math.floor(Math.random() * 10) + 1;
                    return { question: `${num1} + ${num2}`, answer: num1 + num2 };
                }

                const validateForm = () => {
                    const newErrors = {};

                    if (!username.trim()) newErrors.username = 'Username √© obrigat√≥rio';
                    if (!email.trim()) newErrors.email = 'Email √© obrigat√≥rio';
                    if (!/\S+@\S+\.\S+/.test(email)) newErrors.email = 'Email inv√°lido';
                    if (!password) newErrors.password = 'Password √© obrigat√≥ria';
                    if (password.length < 6) newErrors.password = 'Password deve ter pelo menos 6 caracteres';
                    if (password !== confirmPassword) newErrors.confirmPassword = 'Passwords n√£o coincidem';
                    if (parseInt(captcha) !== captchaAnswer.answer) newErrors.captcha = 'Captcha incorreto';

                    setErrors(newErrors);
                    return Object.keys(newErrors).length === 0;
                };

                const handleSubmit = (e) => {
                    e.preventDefault();
                    if (validateForm()) {
                        console.log({ username, email, password });
                        alert('Registro realizado com sucesso!');
                    }
                };

                const refreshCaptcha = () => {
                    setCaptchaAnswer(generateCaptcha());
                    setCaptcha('');
                };

                return (
                    <div style={{ maxWidth: '400px', margin: '2rem auto' }}>
                        <button onClick={() => setCurrentPage('main')} style={{ marginBottom: '1rem' }}>
                            Back
                        </button>
                        <h2>Registro</h2>
                        <form onSubmit={handleSubmit}>
                            <div style={{ marginBottom: '1rem' }}>
                                <label htmlFor="username">Username</label>
                                <input
                                    id="username"
                                    type="text"
                                    value={username}
                                    onChange={e => setUsername(e.target.value)}
                                    style={{ width: '100%', padding: '0.5rem' }}
                                />
                                {errors.username && <small style={{ color: 'red' }}>{errors.username}</small>}
                            </div>

                            <div style={{ marginBottom: '1rem' }}>
                                <label htmlFor="email">Email</label>
                                <input
                                    id="email"
                                    type="email"
                                    value={email}
                                    onChange={e => setEmail(e.target.value)}
                                    style={{ width: '100%', padding: '0.5rem' }}
                                />
                                {errors.email && <small style={{ color: 'red' }}>{errors.email}</small>}
                            </div>

                            <div style={{ marginBottom: '1rem' }}>
                                <label htmlFor="password">Password</label>
                                <input
                                    id="password"
                                    type="password"
                                    value={password}
                                    onChange={e => setPassword(e.target.value)}
                                    style={{ width: '100%', padding: '0.5rem' }}
                                />
                                {errors.password && <small style={{ color: 'red' }}>{errors.password}</small>}
                            </div>

                            <div style={{ marginBottom: '1rem' }}>
                                <label htmlFor="confirmPassword">Confirmar Password</label>
                                <input
                                    id="confirmPassword"
                                    type="password"
                                    value={confirmPassword}
                                    onChange={e => setConfirmPassword(e.target.value)}
                                    style={{ width: '100%', padding: '0.5rem' }}
                                />
                                {errors.confirmPassword && <small style={{ color: 'red' }}>{errors.confirmPassword}</small>}
                            </div>

                            <div style={{ marginBottom: '1rem' }}>
                                <label>Captcha: {captchaAnswer.question} = ?</label>
                                <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>
                                    <input
                                        type="number"
                                        value={captcha}
                                        onChange={e => setCaptcha(e.target.value)}
                                        style={{ padding: '0.5rem', flex: 1 }}
                                        placeholder="Resposta"
                                    />
                                    <button type="button" onClick={refreshCaptcha}>üîÑ</button>
                                </div>
                                {errors.captcha && <small style={{ color: 'red' }}>{errors.captcha}</small>}
                            </div>

                            <button type="submit" style={{ padding: '0.5rem 1rem', width: '100%' }}>
                                Registrar
                            </button>
                        </form>
                    </div>
                );
            }

            function App() {
                const [showAuthMenu, setShowAuthMenu] = React.useState(false);
                const [currentPage, setCurrentPage] = React.useState('main');                if (currentPage === 'login') {
                    return <LoginPage setCurrentPage={setCurrentPage} />;
                }
                
                if (currentPage === 'register') {
                    return <RegisterPage setCurrentPage={setCurrentPage} />;
                }

                return (
                    <div>
                        <div style={{ 
                            display: 'flex', 
                            justifyContent: 'flex-end', 
                            padding: '1rem',
                            position: 'relative'
                        }}>
                            <button 
                                onClick={() => setShowAuthMenu(!showAuthMenu)}
                                style={{ padding: '0.5rem 1rem' }}
                            >
                                Autenticar
                            </button>
                            
                            {showAuthMenu && (
                                <div style={{
                                    position: 'absolute',
                                    top: '100%',
                                    right: '0',
                                    backgroundColor: 'white',
                                    border: '1px solid #ccc',
                                    borderRadius: '4px',
                                    padding: '0.5rem',
                                    boxShadow: '0 2px 8px rgba(0,0,0,0.1)'
                                }}>
                                    <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem' }}>
                                        <button onClick={() => { setCurrentPage('login'); setShowAuthMenu(false); }}>Login</button>
                                        <button onClick={() => { setCurrentPage('register'); setShowAuthMenu(false); }}>Registro</button>
                                    </div>
                                </div>
                            )}
                        </div>
                        
                        <div style={{ padding: '2rem' }}>
                            {/* Main page content - empty for now */}
                        </div>
                    </div>
                );
            }

            const root = ReactDOM.createRoot(document.getElementById('root'));
            root.render(<App />);
        </script>
    </body>
</html>