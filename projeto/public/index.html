<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>ğŸ“ To-Do List - GestÃ£o de Tarefas e NotÃ­cias</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <!-- React and ReactDOM CDN -->
        <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
        <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
        <!-- Babel for JSX support -->
        <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
        <style>
            body { font-family: Arial, sans-serif; margin: 2rem; }
            #root { border: 1px solid #ccc; padding: 2rem; border-radius: 8px; }
        </style>
    </head>
    <body>
        <div id="root"></div>        <script src="../src/services/api.js"></script>
        <script src="../src/services/news.js"></script>
        <script type="text/babel">
// Countries data with flags and news codes
const countries = [
  { code: 'pt', name: 'Portugal', flag: 'ğŸ‡µğŸ‡¹', newsCode: 'pt' },
  { code: 'br', name: 'Brasil', flag: 'ğŸ‡§ğŸ‡·', newsCode: 'br' },
  { code: 'us', name: 'Estados Unidos', flag: 'ğŸ‡ºğŸ‡¸', newsCode: 'us' },
  { code: 'uk', name: 'Reino Unido', flag: 'ğŸ‡¬ğŸ‡§', newsCode: 'gb' },
  { code: 'es', name: 'Espanha', flag: 'ğŸ‡ªğŸ‡¸', newsCode: 'es' },
  { code: 'fr', name: 'FranÃ§a', flag: 'ğŸ‡«ğŸ‡·', newsCode: 'fr' },
  { code: 'de', name: 'Alemanha', flag: 'ğŸ‡©ğŸ‡ª', newsCode: 'de' },
  { code: 'it', name: 'ItÃ¡lia', flag: 'ğŸ‡®ğŸ‡¹', newsCode: 'it' },
  { code: 'ca', name: 'CanadÃ¡', flag: 'ğŸ‡¨ğŸ‡¦', newsCode: 'ca' },
  { code: 'au', name: 'AustrÃ¡lia', flag: 'ğŸ‡¦ğŸ‡º', newsCode: 'au' }
];

function LoginPage({ onSwitchToRegister }) {
  const [email, setEmail] = React.useState('');
  const [password, setPassword] = React.useState('');
  const [error, setError] = React.useState('');
  const [loading, setLoading] = React.useState(false);

  const handleSubmit = async (e) => {
    e.preventDefault();
    setError('');
    setLoading(true);

    try {
      await authService.login({ email, password });
      window.location.reload(); // Refresh to show authenticated state
    } catch (error) {
      setError(error.message);
    } finally {
      setLoading(false);
    }
  };

  return (
    <div style={{ maxWidth: '400px', margin: '0 auto', padding: '2rem' }}>
      <h2>ğŸ” Login</h2>
      <form onSubmit={handleSubmit}>
        <div style={{ marginBottom: '1rem' }}>
          <label>Email</label><br />
          <input
            type="email"
            value={email}
            onChange={e => setEmail(e.target.value)}
            required
            style={{ width: '100%', padding: '0.5rem', marginTop: '0.5rem' }}
          />
        </div>
        <div style={{ marginBottom: '1rem' }}>
          <label>Senha</label><br />
          <input
            type="password"
            value={password}
            onChange={e => setPassword(e.target.value)}
            required
            style={{ width: '100%', padding: '0.5rem', marginTop: '0.5rem' }}
          />
        </div>
        
        {error && (
          <div style={{ color: 'red', marginBottom: '1rem', padding: '0.5rem', backgroundColor: '#ffeeee', border: '1px solid red', borderRadius: '4px' }}>
            {error}
          </div>
        )}
        
        <button 
          type="submit" 
          disabled={loading}
          style={{ 
            width: '100%', 
            padding: '0.75rem', 
            backgroundColor: loading ? '#ccc' : '#007bff', 
            color: 'white', 
            border: 'none', 
            borderRadius: '4px',
            cursor: loading ? 'not-allowed' : 'pointer',
            marginBottom: '1rem'
          }}
        >
          {loading ? 'Entrando...' : 'Entrar'}
        </button>
      </form>
      
      <p style={{ textAlign: 'center' }}>
        NÃ£o tem uma conta? {' '}
        <button 
          onClick={onSwitchToRegister}
          style={{ background: 'none', border: 'none', color: '#007bff', cursor: 'pointer', textDecoration: 'underline' }}
        >
          Registre-se aqui
        </button>
      </p>
    </div>
  );
}

function RegisterPage({ onSwitchToLogin }) {
  const [formData, setFormData] = React.useState({
    username: '',
    email: '',
    password: '',
    confirmPassword: '',
    country: ''
  });
  const [error, setError] = React.useState('');
  const [loading, setLoading] = React.useState(false);

  const handleSubmit = async (e) => {
    e.preventDefault();
    setError('');

    if (formData.password !== formData.confirmPassword) {
      setError('As senhas nÃ£o coincidem');
      return;
    }

    if (!formData.country) {
      setError('Por favor, selecione seu paÃ­s');
      return;
    }

    setLoading(true);

    try {
      const selectedCountry = countries.find(c => c.code === formData.country);
      
      const userData = {
        username: formData.username,
        email: formData.email,
        password: formData.password,
        country: formData.country,
        countryName: selectedCountry.name,
        newsCountryCode: selectedCountry.newsCode,
        registeredAt: new Date().toISOString()
      };

      await authService.register(userData);
      alert('Registro realizado com sucesso! Agora vocÃª pode fazer login.');
      onSwitchToLogin();
    } catch (error) {
      setError(error.message);
    } finally {
      setLoading(false);
    }
  };

  const handleChange = (e) => {
    setFormData(prev => ({
      ...prev,
      [e.target.name]: e.target.value
    }));
  };

  return (
    <div style={{ maxWidth: '400px', margin: '0 auto', padding: '2rem' }}>
      <h2>ğŸ“ Registro</h2>
      <form onSubmit={handleSubmit}>
        <div style={{ marginBottom: '1rem' }}>
          <label>Nome de usuÃ¡rio</label><br />
          <input
            type="text"
            name="username"
            value={formData.username}
            onChange={handleChange}
            required
            style={{ width: '100%', padding: '0.5rem', marginTop: '0.5rem' }}
          />
        </div>
        
        <div style={{ marginBottom: '1rem' }}>
          <label>Email</label><br />
          <input
            type="email"
            name="email"
            value={formData.email}
            onChange={handleChange}
            required
            style={{ width: '100%', padding: '0.5rem', marginTop: '0.5rem' }}
          />
        </div>
        
        <div style={{ marginBottom: '1rem' }}>
          <label>PaÃ­s *</label><br />
          <small style={{ color: '#666' }}>Seu paÃ­s influenciarÃ¡ a priorizaÃ§Ã£o das notÃ­cias por regiÃ£o</small><br />
          <select
            name="country"
            value={formData.country}
            onChange={handleChange}
            required
            style={{ width: '100%', padding: '0.5rem', marginTop: '0.5rem' }}
          >
            <option value="">Selecione seu paÃ­s</option>
            {countries.map(country => (
              <option key={country.code} value={country.code}>
                {country.flag} {country.name}
              </option>
            ))}
          </select>
        </div>
        
        <div style={{ marginBottom: '1rem' }}>
          <label>Senha</label><br />
          <input
            type="password"
            name="password"
            value={formData.password}
            onChange={handleChange}
            required
            style={{ width: '100%', padding: '0.5rem', marginTop: '0.5rem' }}
          />
        </div>
        
        <div style={{ marginBottom: '1rem' }}>
          <label>Confirmar senha</label><br />
          <input
            type="password"
            name="confirmPassword"
            value={formData.confirmPassword}
            onChange={handleChange}
            required
            style={{ width: '100%', padding: '0.5rem', marginTop: '0.5rem' }}
          />
        </div>
        
        {error && (
          <div style={{ color: 'red', marginBottom: '1rem', padding: '0.5rem', backgroundColor: '#ffeeee', border: '1px solid red', borderRadius: '4px' }}>
            {error}
          </div>
        )}
        
        <button 
          type="submit" 
          disabled={loading}
          style={{ 
            width: '100%', 
            padding: '0.75rem', 
            backgroundColor: loading ? '#ccc' : '#28a745', 
            color: 'white', 
            border: 'none', 
            borderRadius: '4px',
            cursor: loading ? 'not-allowed' : 'pointer',
            marginBottom: '1rem'
          }}
        >
          {loading ? 'Registrando...' : 'Registrar'}
        </button>
      </form>
      
      <p style={{ textAlign: 'center' }}>
        JÃ¡ tem uma conta? {' '}
        <button 
          onClick={onSwitchToLogin}
          style={{ background: 'none', border: 'none', color: '#007bff', cursor: 'pointer', textDecoration: 'underline' }}
        >
          FaÃ§a login aqui
        </button>
      </p>
    </div>
  );
}

function TaskForm({ onTaskCreated }) {
  const [formData, setFormData] = React.useState({
    title: '',
    description: '',
    priority: 'mÃ©dia',
    dueDate: '',
    category: 'pessoal'
  });

  const handleSubmit = async (e) => {
    e.preventDefault();
    try {
      const task = await tasksService.createTask({
        ...formData,
        status: 'pendente'
      });
      onTaskCreated(task);
      setFormData({ title: '', description: '', priority: 'mÃ©dia', dueDate: '', category: 'pessoal' });
    } catch (error) {
      alert('Erro ao criar tarefa: ' + error.message);
    }
  };

  const handleChange = (e) => {
    setFormData(prev => ({
      ...prev,
      [e.target.name]: e.target.value
    }));
  };

  return (
    <form onSubmit={handleSubmit} style={{ marginBottom: '1.5rem', padding: '1rem', border: '1px solid #ddd', borderRadius: '8px', backgroundColor: '#f8f9fa' }}>
      <h4 style={{ margin: '0 0 1rem 0' }}>â• Nova Tarefa</h4>
      
      <div style={{ marginBottom: '1rem' }}>
        <label style={{ fontSize: '0.9rem' }}>TÃ­tulo *</label><br />
        <input
          type="text"
          name="title"
          value={formData.title}
          onChange={handleChange}
          required
          style={{ width: '100%', padding: '0.5rem', fontSize: '0.9rem' }}
        />
      </div>
      
      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem', marginBottom: '1rem' }}>
        <div>
          <label style={{ fontSize: '0.9rem' }}>Categoria</label><br />
          <select
            name="category"
            value={formData.category}
            onChange={handleChange}
            style={{ width: '100%', padding: '0.5rem', fontSize: '0.9rem' }}
          >
            <option value="pessoal">Pessoal</option>
            <option value="trabalho">Trabalho</option>
            <option value="estudos">Estudos</option>
            <option value="saude">SaÃºde</option>
            <option value="financas">FinanÃ§as</option>
          </select>
        </div>
        
        <div>
          <label style={{ fontSize: '0.9rem' }}>Prioridade</label><br />
          <select
            name="priority"
            value={formData.priority}
            onChange={handleChange}
            style={{ width: '100%', padding: '0.5rem', fontSize: '0.9rem' }}
          >
            <option value="baixa">ğŸŸ¢ Baixa</option>
            <option value="mÃ©dia">ğŸŸ¡ MÃ©dia</option>
            <option value="alta">ğŸŸ  Alta</option>
            <option value="urgente">ğŸ”´ Urgente</option>
          </select>
        </div>
      </div>
      
      <div style={{ marginBottom: '1rem' }}>
        <label style={{ fontSize: '0.9rem' }}>DescriÃ§Ã£o</label><br />
        <textarea
          name="description"
          value={formData.description}
          onChange={handleChange}
          style={{ width: '100%', padding: '0.5rem', minHeight: '60px', fontSize: '0.9rem' }}
          placeholder="Descreva sua tarefa..."
        />
      </div>
      
      <div style={{ marginBottom: '1rem' }}>
        <label style={{ fontSize: '0.9rem' }}>Data limite</label><br />
        <input
          type="datetime-local"
          name="dueDate"
          value={formData.dueDate}
          onChange={handleChange}
          style={{ width: '100%', padding: '0.5rem', fontSize: '0.9rem' }}
        />
      </div>
      
      <button type="submit" style={{ width: '100%', padding: '0.6rem', backgroundColor: '#28a745', color: 'white', border: 'none', borderRadius: '4px', cursor: 'pointer', fontSize: '0.9rem' }}>
        Criar Tarefa
      </button>
    </form>
  );
}

function TaskItem({ task, onTaskUpdated, onTaskDeleted, compact = false }) {
  const [isEditing, setIsEditing] = React.useState(false);
  const [editData, setEditData] = React.useState(task);

  const priorityColors = {
    baixa: '#28a745',
    mÃ©dia: '#ffc107',
    alta: '#fd7e14',
    urgente: '#dc3545'
  };

  const statusIcons = {
    pendente: 'â³',
    em_progresso: 'ğŸ”„',
    concluÃ­da: 'âœ…'
  };

  const handleStatusChange = async (newStatus) => {
    try {
      const updatedTask = await tasksService.updateTask(task._id, { status: newStatus });
      onTaskUpdated(updatedTask);
    } catch (error) {
      alert('Erro ao atualizar tarefa: ' + error.message);
    }
  };

  const handleSaveEdit = async () => {
    try {
      const updatedTask = await tasksService.updateTask(task._id, editData);
      onTaskUpdated(updatedTask);
      setIsEditing(false);
    } catch (error) {
      alert('Erro ao salvar ediÃ§Ã£o: ' + error.message);
    }
  };

  const handleDelete = async () => {
    if (confirm('Tem certeza que deseja deletar esta tarefa?')) {
      try {
        await tasksService.deleteTask(task._id);
        onTaskDeleted(task._id);
      } catch (error) {
        alert('Erro ao deletar tarefa: ' + error.message);
      }
    }
  };

  const isOverdue = task.dueDate && new Date(task.dueDate) < new Date() && task.status !== 'concluÃ­da';

  if (isEditing) {
    return (
      <div style={{ 
        padding: compact ? '0.5rem' : '1rem', 
        border: '1px solid #ddd', 
        borderRadius: '8px', 
        marginBottom: compact ? '0.5rem' : '1rem',
        backgroundColor: '#f8f9fa',
        fontSize: compact ? '0.9rem' : '1rem'
      }}>
        <div style={{ marginBottom: '0.5rem' }}>
          <input
            type="text"
            value={editData.title}
            onChange={e => setEditData(prev => ({ ...prev, title: e.target.value }))}
            style={{ width: '100%', padding: '0.25rem', fontSize: compact ? '0.8rem' : '0.9rem' }}
          />
        </div>
        <div style={{ marginBottom: '0.5rem' }}>
          <textarea
            value={editData.description}
            onChange={e => setEditData(prev => ({ ...prev, description: e.target.value }))}
            style={{ width: '100%', padding: '0.25rem', minHeight: compact ? '40px' : '60px', fontSize: compact ? '0.8rem' : '0.9rem' }}
          />
        </div>
        <div style={{ display: 'flex', gap: '0.25rem' }}>
          <button onClick={handleSaveEdit} style={{ padding: '0.25rem 0.5rem', backgroundColor: '#28a745', color: 'white', border: 'none', borderRadius: '4px', fontSize: compact ? '0.7rem' : '0.8rem' }}>
            âœ“
          </button>
          <button onClick={() => setIsEditing(false)} style={{ padding: '0.25rem 0.5rem', backgroundColor: '#6c757d', color: 'white', border: 'none', borderRadius: '4px', fontSize: compact ? '0.7rem' : '0.8rem' }}>
            âœ•
          </button>
        </div>
      </div>
    );
  }

  return (
    <div style={{ 
      padding: compact ? '0.5rem' : '1rem', 
      border: `1px solid ${isOverdue ? '#dc3545' : '#ddd'}`, 
      borderRadius: '8px', 
      marginBottom: compact ? '0.5rem' : '1rem',
      backgroundColor: isOverdue ? '#fff5f5' : 'white',
      opacity: task.status === 'concluÃ­da' ? 0.7 : 1,
      fontSize: compact ? '0.8rem' : '1rem'
    }}>
      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '0.25rem' }}>
        <h4 style={{ 
          margin: 0, 
          textDecoration: task.status === 'concluÃ­da' ? 'line-through' : 'none',
          color: isOverdue ? '#dc3545' : 'inherit',
          fontSize: compact ? '0.9rem' : '1.1rem',
          lineHeight: '1.2'
        }}>
          {statusIcons[task.status]} {task.title}
        </h4>
        <span style={{ 
          backgroundColor: priorityColors[task.priority], 
          color: 'white', 
          padding: compact ? '0.125rem 0.25rem' : '0.25rem 0.5rem', 
          borderRadius: '12px', 
          fontSize: compact ? '0.6rem' : '0.8rem',
          fontWeight: 'bold',
          flexShrink: 0
        }}>
          {task.priority}
        </span>
      </div>
      
      {task.description && !compact && (
        <p style={{ margin: '0.25rem 0', color: '#666', fontSize: compact ? '0.7rem' : '0.9rem' }}>{task.description}</p>
      )}
      
      <div style={{ display: 'flex', gap: compact ? '0.5rem' : '1rem', marginBottom: compact ? '0.5rem' : '1rem', fontSize: compact ? '0.7rem' : '0.9rem', color: '#666', flexWrap: 'wrap' }}>
        <span>ğŸ“‚ {task.category}</span>
        {task.dueDate && (
          <span style={{ color: isOverdue ? '#dc3545' : 'inherit' }}>
            â° {new Date(task.dueDate).toLocaleDateString('pt-BR')}
            {isOverdue && ' (!)'}
          </span>
        )}
      </div>
      
      <div style={{ display: 'flex', gap: '0.25rem', flexWrap: 'wrap' }}>
        <select
          value={task.status}
          onChange={e => handleStatusChange(e.target.value)}
          style={{ padding: compact ? '0.125rem' : '0.25rem', fontSize: compact ? '0.7rem' : '0.9rem', flex: compact ? 'none' : '1' }}
        >
          <option value="pendente">â³ Pendente</option>
          <option value="em_progresso">ğŸ”„ Em Progresso</option>
          <option value="concluÃ­da">âœ… ConcluÃ­da</option>
        </select>
        
        <button 
          onClick={() => setIsEditing(true)}
          style={{ padding: compact ? '0.125rem 0.25rem' : '0.25rem 0.5rem', backgroundColor: '#007bff', color: 'white', border: 'none', borderRadius: '4px', fontSize: compact ? '0.7rem' : '0.9rem' }}
        >
          {compact ? 'âœï¸' : 'âœï¸ Editar'}
        </button>
        
        <button 
          onClick={handleDelete}
          style={{ padding: compact ? '0.125rem 0.25rem' : '0.25rem 0.5rem', backgroundColor: '#dc3545', color: 'white', border: 'none', borderRadius: '4px', fontSize: compact ? '0.7rem' : '0.9rem' }}
        >
          {compact ? 'ğŸ—‘ï¸' : 'ğŸ—‘ï¸ Deletar'}
        </button>
      </div>
    </div>
  );
}

function NewsSection() {
  const [news, setNews] = React.useState([]);
  const [loading, setLoading] = React.useState(true);
  const [selectedCategory, setSelectedCategory] = React.useState('general');
  const [userCountry, setUserCountry] = React.useState(null);

  const categories = [
    { id: 'general', name: 'Geral', icon: 'ğŸ“°' },
    { id: 'business', name: 'NegÃ³cios', icon: 'ğŸ’¼' },
    { id: 'technology', name: 'Tecnologia', icon: 'ğŸ’»' },
    { id: 'sports', name: 'Esportes', icon: 'âš½' },
    { id: 'health', name: 'SaÃºde', icon: 'ğŸ¥' },
    { id: 'entertainment', name: 'Entretenimento', icon: 'ğŸ¬' }
  ];

  React.useEffect(() => {
    const user = authService.getUser();
    if (user && user.country) {
      const country = countries.find(c => c.code === user.country);
      setUserCountry(country);
    }
  }, []);

  React.useEffect(() => {
    loadNews();
  }, [selectedCategory, userCountry]);

  const loadNews = async () => {
    setLoading(true);
    try {
      const countryCode = userCountry?.newsCode || 'us';
      const articles = await newsService.getNewsByCategory(selectedCategory, countryCode);
      setNews(articles);
    } catch (error) {
      console.error('Erro ao carregar notÃ­cias:', error);
    } finally {
      setLoading(false);
    }
  };

  return (
    <div>
      <div style={{ display: 'flex', alignItems: 'center', marginBottom: '1rem' }}>
        <h3 style={{ margin: 0, marginRight: '1rem' }}>ğŸ“° NotÃ­cias</h3>
        {userCountry && (
          <span style={{ 
            backgroundColor: '#e9ecef', 
            padding: '0.25rem 0.5rem', 
            borderRadius: '12px', 
            fontSize: '0.8rem',
            display: 'flex',
            alignItems: 'center',
            gap: '0.25rem'
          }}>
            {userCountry.flag} {userCountry.name}
          </span>
        )}
      </div>
      
      <div style={{ marginBottom: '1rem', display: 'flex', gap: '0.5rem', flexWrap: 'wrap' }}>
        {categories.map(category => (
          <button
            key={category.id}
            onClick={() => setSelectedCategory(category.id)}
            style={{
              padding: '0.4rem 0.8rem',
              border: '1px solid #ddd',
              borderRadius: '15px',
              backgroundColor: selectedCategory === category.id ? '#007bff' : 'white',
              color: selectedCategory === category.id ? 'white' : '#333',
              cursor: 'pointer',
              fontSize: '0.8rem'
            }}
          >
            {category.icon} {category.name}
          </button>
        ))}
      </div>
      
      {loading ? (
        <div style={{ textAlign: 'center', padding: '2rem' }}>
          <p>Carregando notÃ­cias...</p>
        </div>
      ) : (
        <div style={{ maxHeight: '70vh', overflowY: 'auto', paddingRight: '0.5rem' }}>
          {news.length > 0 ? (
            news.slice(0, 8).map((article, index) => (
              <div key={index} style={{ 
                border: '1px solid #ddd', 
                borderRadius: '8px', 
                padding: '1rem',
                marginBottom: '1rem',
                display: 'flex',
                flexDirection: 'column',
                gap: '0.5rem'
              }}>
                {article.urlToImage && (
                  <img 
                    src={article.urlToImage} 
                    alt={article.title}
                    style={{ 
                      width: '100%', 
                      height: '150px', 
                      objectFit: 'cover', 
                      borderRadius: '4px'
                    }}
                  />
                )}
                <div>
                  <h4 style={{ margin: '0 0 0.5rem 0', fontSize: '0.95rem', lineHeight: '1.3' }}>
                    <a 
                      href={article.url} 
                      target="_blank" 
                      rel="noopener noreferrer"
                      style={{ textDecoration: 'none', color: '#333' }}
                    >
                      {article.title}
                    </a>
                  </h4>
                  {article.description && (
                    <p style={{ margin: '0 0 0.5rem 0', color: '#666', fontSize: '0.85rem', lineHeight: '1.4' }}>
                      {article.description.substring(0, 120)}...
                    </p>
                  )}
                  <div style={{ fontSize: '0.75rem', color: '#999' }}>
                    {article.source?.name} â€¢ {new Date(article.publishedAt).toLocaleDateString('pt-BR')}
                  </div>
                </div>
              </div>
            ))
          ) : (
            <div style={{ textAlign: 'center', padding: '2rem', color: '#666' }}>
              <p>Nenhuma notÃ­cia encontrada para esta categoria.</p>
            </div>
          )}
        </div>
      )}
    </div>
  );
}

function TasksDashboard({ tasks, onTaskUpdated, onTaskDeleted }) {
  const [filteredTasks, setFilteredTasks] = React.useState([]);
  const [filterStatus, setFilterStatus] = React.useState('todas');
  const [filterPriority, setFilterPriority] = React.useState('todas');
  const [stats, setStats] = React.useState({});

  React.useEffect(() => {
    applyFilters();
    setStats(tasksService.getStats());
  }, [tasks, filterStatus, filterPriority]);

  const applyFilters = () => {
    let filtered = tasks;

    if (filterStatus !== 'todas') {
      filtered = filtered.filter(task => task.status === filterStatus);
    }

    if (filterPriority !== 'todas') {
      filtered = filtered.filter(task => task.priority === filterPriority);
    }

    setFilteredTasks(filtered);
  };

  return (
    <div>
      <h3 style={{ marginBottom: '1rem' }}>ğŸ“‹ Dashboard de Tarefas</h3>
      
      {/* Mini Stats */}
      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '0.5rem', marginBottom: '1rem' }}>
        <div style={{ padding: '0.5rem', backgroundColor: '#e3f2fd', borderRadius: '6px', textAlign: 'center' }}>
          <div style={{ fontSize: '1.2rem', fontWeight: 'bold', color: '#1976d2' }}>{stats.total || 0}</div>
          <div style={{ fontSize: '0.8rem', color: '#666' }}>Total</div>
        </div>
        <div style={{ padding: '0.5rem', backgroundColor: '#fff3e0', borderRadius: '6px', textAlign: 'center' }}>
          <div style={{ fontSize: '1.2rem', fontWeight: 'bold', color: '#f57c00' }}>{stats.pending || 0}</div>
          <div style={{ fontSize: '0.8rem', color: '#666' }}>Pendentes</div>
        </div>
        <div style={{ padding: '0.5rem', backgroundColor: '#e8f5e8', borderRadius: '6px', textAlign: 'center' }}>
          <div style={{ fontSize: '1.2rem', fontWeight: 'bold', color: '#388e3c' }}>{stats.completed || 0}</div>
          <div style={{ fontSize: '0.8rem', color: '#666' }}>ConcluÃ­das</div>
        </div>
        <div style={{ padding: '0.5rem', backgroundColor: '#ffebee', borderRadius: '6px', textAlign: 'center' }}>
          <div style={{ fontSize: '1.2rem', fontWeight: 'bold', color: '#d32f2f' }}>{stats.overdue || 0}</div>
          <div style={{ fontSize: '0.8rem', color: '#666' }}>Atrasadas</div>
        </div>
      </div>

      {/* Compact Filters */}
      <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '1rem', fontSize: '0.9rem' }}>
        <select
          value={filterStatus}
          onChange={e => setFilterStatus(e.target.value)}
          style={{ padding: '0.25rem', fontSize: '0.8rem', flex: 1 }}
        >
          <option value="todas">Todos Status</option>
          <option value="pendente">Pendentes</option>
          <option value="em_progresso">Em Progresso</option>
          <option value="concluÃ­da">ConcluÃ­das</option>
        </select>
        
        <select
          value={filterPriority}
          onChange={e => setFilterPriority(e.target.value)}
          style={{ padding: '0.25rem', fontSize: '0.8rem', flex: 1 }}
        >
          <option value="todas">Todas Prioridades</option>
          <option value="baixa">Baixa</option>
          <option value="mÃ©dia">MÃ©dia</option>
          <option value="alta">Alta</option>
          <option value="urgente">Urgente</option>
        </select>
      </div>

      {/* Compact Tasks List */}
      <div style={{ maxHeight: '600px', overflowY: 'auto' }}>
        {filteredTasks.length > 0 ? (
          filteredTasks.map(task => (
            <TaskItem
              key={task._id}
              task={task}
              onTaskUpdated={onTaskUpdated}
              onTaskDeleted={onTaskDeleted}
              compact={true}
            />
          ))
        ) : (
          <div style={{ textAlign: 'center', padding: '1rem', color: '#666', fontSize: '0.9rem' }}>
            <p>Nenhuma tarefa encontrada.</p>
          </div>
        )}
      </div>
    </div>
  );
}

function CreateTaskPage({ onTaskCreated, onBack }) {
  return (
    <div style={{ maxWidth: '600px', margin: '0 auto', padding: '2rem' }}>
      <div style={{ marginBottom: '2rem' }}>
        <button 
          onClick={onBack}
          style={{ 
            padding: '0.5rem 1rem', 
            backgroundColor: '#6c757d', 
            color: 'white', 
            border: 'none', 
            borderRadius: '4px', 
            cursor: 'pointer',
            marginBottom: '1rem'
          }}
        >
          â† Voltar
        </button>
        <h2>â• Criar Nova Tarefa</h2>
      </div>
      
      <TaskForm onTaskCreated={onTaskCreated} />
    </div>
  );
}

function Dashboard() {
  const [tasks, setTasks] = React.useState([]);
  const [user, setUser] = React.useState(null);
  const [currentView, setCurrentView] = React.useState('dashboard'); // 'dashboard' or 'create'

  React.useEffect(() => {
    loadTasks();
    setUser(authService.getUser());
  }, []);

  const loadTasks = async () => {
    try {
      const tasksData = await tasksService.getTasks();
      setTasks(tasksData);
    } catch (error) {
      console.error('Erro ao carregar tarefas:', error);
    }
  };

  const handleTaskCreated = (newTask) => {
    setTasks(prev => [newTask, ...prev]);
    setCurrentView('dashboard'); // Volta para o dashboard apÃ³s criar
  };

  const handleTaskUpdated = (updatedTask) => {
    setTasks(prev => prev.map(task => 
      task._id === updatedTask._id ? updatedTask : task
    ));
  };

  const handleTaskDeleted = (taskId) => {
    setTasks(prev => prev.filter(task => task._id !== taskId));
  };

  const handleLogout = () => {
    authService.logout();
    window.location.reload();
  };

  if (currentView === 'create') {
    return (
      <CreateTaskPage 
        onTaskCreated={handleTaskCreated}
        onBack={() => setCurrentView('dashboard')}
      />
    );
  }

  return (
    <div style={{ maxWidth: '1400px', margin: '0 auto', padding: '1rem' }}>
      <header style={{ 
        display: 'flex', 
        justifyContent: 'space-between', 
        alignItems: 'center', 
        marginBottom: '1rem', 
        paddingBottom: '1rem', 
        borderBottom: '1px solid #ddd' 
      }}>
        <h1 style={{ margin: 0 }}>ğŸ“ To-Do List & NotÃ­cias</h1>
        <div style={{ display: 'flex', alignItems: 'center', gap: '1rem' }}>
          <button 
            onClick={() => setCurrentView('create')}
            style={{ 
              padding: '0.5rem 1rem', 
              backgroundColor: '#28a745', 
              color: 'white', 
              border: 'none', 
              borderRadius: '4px', 
              cursor: 'pointer' 
            }}
          >
            â• Nova Tarefa
          </button>
          {user && (
            <span style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
              ğŸ‘¤ {user.username}
              {user.country && (
                <span>
                  {countries.find(c => c.code === user.country)?.flag}
                </span>
              )}
            </span>
          )}
          <button 
            onClick={handleLogout}
            style={{ 
              padding: '0.5rem 1rem', 
              backgroundColor: '#dc3545', 
              color: 'white', 
              border: 'none', 
              borderRadius: '4px', 
              cursor: 'pointer' 
            }}
          >
            ğŸšª Sair
          </button>
        </div>
      </header>

      {/* Layout em duas colunas */}
      <div style={{ display: 'grid', gridTemplateColumns: '1fr 400px', gap: '2rem', height: 'calc(100vh - 150px)' }}>
        {/* Coluna esquerda - NotÃ­cias */}
        <div style={{ overflow: 'hidden' }}>
          <NewsSection />
        </div>

        {/* Coluna direita - Dashboard de Tarefas */}
        <div style={{ 
          padding: '1rem', 
          border: '1px solid #ddd', 
          borderRadius: '8px', 
          backgroundColor: '#f8f9fa',
          overflow: 'hidden'
        }}>
          <TasksDashboard
            tasks={tasks}
            onTaskUpdated={handleTaskUpdated}
            onTaskDeleted={handleTaskDeleted}
          />
        </div>
      </div>
    </div>  );
}

function App() {
  const [currentPage, setCurrentPage] = React.useState('login');
  const [isAuthenticated, setIsAuthenticated] = React.useState(false);

  React.useEffect(() => {
    setIsAuthenticated(authService.isAuthenticated());
  }, []);

  if (isAuthenticated) {
    return <Dashboard />;
  }

  return (
    <div>
      {currentPage === 'login' ? (
        <LoginPage onSwitchToRegister={() => setCurrentPage('register')} />
      ) : (
        <RegisterPage onSwitchToLogin={() => setCurrentPage('login')} />
      )}
    </div>
  );
}

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<App />);
        </script>
    </body>
</html>